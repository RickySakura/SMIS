/*! Copyright © 2011 - 2021 miHoYo. All Rights Reserved */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.miHoYoAnalysis=t():e.miHoYoAnalysis=t()}(window,(function(){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){var o,i;
/*!
 * JavaScript Cookie v2.2.1
 * https://github.com/js-cookie/js-cookie
 *
 * Copyright 2006, 2015 Klaus Hartl & Fagner Brack
 * Released under the MIT license
 */!function(r){if(void 0===(i="function"==typeof(o=r)?o.call(t,n,t,e):o)||(e.exports=i),!0,e.exports=r(),!!0){var a=window.Cookies,u=window.Cookies=r();u.noConflict=function(){return window.Cookies=a,u}}}((function(){function e(){for(var e=0,t={};e<arguments.length;e++){var n=arguments[e];for(var o in n)t[o]=n[o]}return t}function t(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function n(o){function i(){}function r(t,n,r){if("undefined"!=typeof document){"number"==typeof(r=e({path:"/"},i.defaults,r)).expires&&(r.expires=new Date(1*new Date+864e5*r.expires)),r.expires=r.expires?r.expires.toUTCString():"";try{var a=JSON.stringify(n);/^[\{\[]/.test(a)&&(n=a)}catch(e){}n=o.write?o.write(n,t):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var u="";for(var c in r)r[c]&&(u+="; "+c,!0!==r[c]&&(u+="="+r[c].split(";")[0]));return document.cookie=t+"="+n+u}}function a(e,n){if("undefined"!=typeof document){for(var i={},r=document.cookie?document.cookie.split("; "):[],a=0;a<r.length;a++){var u=r[a].split("="),c=u.slice(1).join("=");n||'"'!==c.charAt(0)||(c=c.slice(1,-1));try{var s=t(u[0]);if(c=(o.read||o)(c,s)||t(c),n)try{c=JSON.parse(c)}catch(e){}if(i[s]=c,e===s)break}catch(e){}}return e?i[e]:i}}return i.set=r,i.get=function(e){return a(e,!1)},i.getJSON=function(e){return a(e,!0)},i.remove=function(t,n){r(t,"",e(n,{expires:-1}))},i.defaults={},i.withConverter=n,i}((function(){}))}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=c(n(2)),a=c(n(0)),u=n(3);function c(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.app_id="",this.data_belong="",this.game_uid="",this.game_region="",this.needUid=!1,this.hasUpdateUid=!1,this.uuid=r.default.getUuid()||"",this.pvParams={eventCategory:"page",eventAction:"view",eventLabel:"",eventValue:""},this.pagename=void 0,this.pageurl=void 0,this.type="tool",this.bbsApp=void 0,this.device_id="",this.pageExtrainfo=void 0,this.userExtrainfo=void 0,this.eventExtrainfo=void 0,this.apis={production:"https://log-upload.mihoyo.com/h5/upload",sea:"https://log-upload-os.mihoyo.com/h5/upload",test:"https://devlog-upload.mihoyo.com/h5/upload",development:"https://devlog-upload.mihoyo.com/h5/upload"},this.eventList=[],this.environment=this.getEnv()}return i(e,[{key:"getEnv",value:function(){var e=window.location.host;return e.indexOf("webstatic.mihoyo.com")>-1?"production":e.indexOf("webstatic-sea.mihoyo.com")>-1?"sea":e.indexOf("-test.mihoyo.com")>-1?"test":"production"}},{key:"getParamByName",value:function(e){var t=e.replace(/[\[\]]/g,"\\$&"),n=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)"),o=window.location.search,i=n.exec(o);if(i)return i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):""}},{key:"getAccountid",value:function(){return a.default.get("account_id")||a.default.get("ltuid")}},{key:"getBh3SeaAccountid",value:function(){return a.default.get("bh3LoginUid")}},{key:"isHash",value:function(){return window.location.href.indexOf("#/")>-1}},{key:"getPageInfo",value:function(){var e=this.isHash()?window.location.hash.replace("#",""):window.location.pathname;return{app_id:this.app_id,page_url:this.pageurl||e,page_name:this.pagename||e,page_fullurl:window.location.href,utm_source:this.getParamByName("utm_source"),utm_medium:this.getParamByName("utm_medium"),utm_campaign:this.getParamByName("utm_campaign"),document_referrer:document.referrer,extra_info:this.pageExtrainfo}}},{key:"getUserInfo",value:function(){return{auth_key:this.getParamByName("authkey")||"",authkey_ver:this.getParamByName("authkey_ver"),game_biz:this.getParamByName("game_biz")||"",account_id:this.getAccountid()||"",bh3_sea_account_id:this.getBh3SeaAccountid(),game_uid:this.game_uid,game_region:this.game_region,uuid:this.uuid,device_id:this.device_id,extra_info:this.userExtrainfo}}},{key:"getEventInfo",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.eventCategory,n=e.eventAction,i=e.eventLabel,r=e.eventValue,a=e.extraInfo,u=void 0===a?{}:a,c={eventCategory:t,eventAction:n,eventLabel:i,eventValue:r,timestamp:(new Date).getTime(),extra_info:o({},this.eventExtrainfo||{},u)};return c}},{key:"getAllParams",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n={page_info:this.getPageInfo(),user_info:this.getUserInfo(),event_info:this.getEventInfo(t),type:this.type,data_belong:this.data_belong};return new Promise((function(t){e.bbsApp&&e.bbsApp.appVersion&&!e.device_id?e.bbsApp.getHTTPRequestHeaders().then((function(o){if(o&&o.data&&o.data["x-rpc-device_id"]){var i=o.data["x-rpc-device_id"];e.device_id=i,n.user_info.device_id=i}t(n)})):t(n)}))}},{key:"trackEvent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};try{var a={eventCategory:e,eventAction:t,eventLabel:n,eventValue:i,extraInfo:"[object Object]"===Object.prototype.toString.call(r)?r:{}};this.getAllParams(a).then((function(e){o.post(e)}))}catch(e){console.log(e)}}},{key:"trackPageview",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{var n=t.path,o=t.name;n&&(this.pageurl=n),o&&(this.pagename=o),this.getAllParams(this.pvParams).then((function(t){e.post(t)}))}catch(e){console.log(e)}}},{key:"updateUid",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.hasUpdateUid=!0;var n=t.uid,o=t.region;this.game_uid=n,this.game_region=o,this.eventList.forEach((function(t,n){n>10||setTimeout((function(){try{t.user_info.game_uid=e.game_uid,t.user_info.game_region=e.game_region,e.post(t)}catch(e){console.error(e)}}),200*n)})),this.eventList=[]}},{key:"post",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{var t=this.apis[this.environment];if(!t)return;var n=new XMLHttpRequest;n.open("POST",t,!0),n.setRequestHeader("Content-Type","application/json"),n.send(JSON.stringify(e))}catch(e){console.error(e)}}}],[{key:"install",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new this;(0,u.initInstance)(n,o({Vue:e},t))}},{key:"init",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new this;return(0,u.initInstance)(t,e)}}]),e}();t.default=s},function(e,t,n){var o;"undefined"!=typeof self&&self,e.exports=(o=n(0),function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,i=(o=n(1))&&o.__esModule?o:{default:o};function r(e){window.location.host.indexOf(".mihoyo.com")>-1?i.default.set("_MHYUUID",e,{domain:".mihoyo.com",path:"/",expires:365}):window.location.host.indexOf(".hoyolab.com")>-1?i.default.set("_MHYUUID",e,{domain:".hoyolab.com",path:"/",expires:365}):i.default.set("_MHYUUID",e,{path:"/",expires:365})}t.default={getVisitorId:function(){var e=this;return new Promise((function(t){t(e.getUuid())}))},getUuid:function(){var e=i.default.get("_MHYUUID");if(e)return r(e),e;for(var t=[],n=0;n<36;n++)t[n]="0123456789abcdef".substr(Math.floor(16*Math.random()),1);return t[14]="4",t[19]="0123456789abcdef".substr(3&t[19]|8,1),t[8]=t[13]=t[18]=t[23]="-",r(e=t.join("")),e}}},function(e,t){e.exports=o}]).default)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initInstance=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.Vue,o=t.dataBelong,i=void 0===o?[]:o,r=t.appId,a=t.router,u=t.needUid,c=t.env,s=t.isSea,d=void 0!==s&&s,f=t.debug,l=void 0!==f&&f,p=t.pagename,v=t.device_id,h=void 0===v?"":v,g=t.pageExtrainfo,m=t.userExtrainfo,y=t.eventExtrainfo,_=t.type,b=void 0===_?"tool":_,w=t.autoTrackPageview,x=void 0===w||w,P=t.setMiaToVue,O=void 0===P||P,k=n||window.Vue;if(!r)throw console.error("请传入appId"),new Error("请传入appId");if(!Array.isArray(i))throw console.error("dataBelong的类型为数组"),e.data_belong="",new Error("dataBelong的类型为数组");return e.data_belong=i.join(","),c&&e.apis[c]&&(e.environment=c),d&&"production"===e.environment&&(e.environment="sea"),l&&(e.environment="test"),k&&O&&(k.prototype.$mia=e),e.app_id=""+r,e.needUid=u||!1,e.pagename=p,e.pageExtrainfo=g,e.userExtrainfo=m,e.eventExtrainfo=y,e.type=b,e.device_id=h,e.bbsApp=k&&k.prototype.$bbsApp,x&&(k?a&&a.afterEach((function(t){var n=t||{},o=(n.meta||{}).miaPagename;e.pageurl=n.path,e.pagename=o||n.name||n.path,e.trackPageview()})):e.trackPageview()),e}}]).default}));